# 详情页优化与首屏优化

## 详情页

在列表页进入详情页之前，将点击的对应详情页数据存入全局状态中，进入详情页后，如果有这个状态，不需要请求，如果没有，则正常请求

这样进入详情页就直接渲染页面，而不用加载状态

这样也可以兼容未从列表页跳转的情况

如果有其他不是列表页跳转可以拿到的额外展示数据，使用骨架屏进行加载，往往用户滑动到时也已经加载完成

另外，详情页可以进行请求缓存，第二次进入也无需加载，ahooks 的 useRequest 支持该功能

## 首屏

首屏性能首先可以通过浏览器控制台的 performance 进行测试，针对性查看

如果是接口问题，首屏的，用户第一眼看到的部分可以单独使用接口加载，滚动后的部分使用骨架屏等状态进行加载，而且可以对图片等资源进行懒加载和不用骨架屏用 hash 美化处理

如果不是，而且使用的框架，则一般不是打包问题

那么可以考虑使用 redis 缓存数据

或者配置 cdn

如果需要首屏直接加载所有内容，则需要 ssr

> 如果是打包问题，应该是分包影响了缓存

先查看首页加载时 html 和 js 大小情况，然后如果需要则进行打包配置，假设是 webpack：

1.首先将 webpack 运行时代码分离出来，因为 chunk 代码变动时 hash 变动会导致运行时代码的 hash 变动，影响缓存，具体见 webapck 源码，笔记

2.react 等框架的运行时代码以及其所有依赖单独抽离
