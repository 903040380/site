<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ZEROPRESS</title>
  <link rel="stylesheet" href="/assets/client-entry-Dj2YQCT4.css">
  <body>
    <div id="root"><header class="pc:fixed absolute left-0 top-0 z-50 w-full"><div class="border-divider bg-bg-default h-nav border-b px-[12px] pt-px transition-colors duration-300"><div class="flex h-full items-center justify-between"><div class="flex h-full justify-start"><div class="h-full"><nav class="mx-[12px] flex h-full items-center"><a class="cursor-pointer"><img src="/logo.jpg" class="h-[24px] w-[24px]"/></a></nav></div></div><div class="flex h-full justify-end"><div class="h-full"><nav class="mx-[12px] h-full justify-end"><a class="cursor-pointer text-text-2 text-hover flex h-full items-center whitespace-nowrap text-[14px] font-[500]">http</a></nav></div><div class="h-full"><nav class="mx-[12px] h-full justify-end"><a class="cursor-pointer text-text-2 text-hover flex h-full items-center whitespace-nowrap text-[14px] font-[500]">react17</a></nav></div><div class="h-full"><nav class="mx-[12px] h-full justify-end"><a class="cursor-pointer text-text-2 text-hover flex h-full items-center whitespace-nowrap text-[14px] font-[500]">数据结构与算法</a></nav></div><div class="h-full"><nav class="mx-[12px] h-full justify-end"><a class="cursor-pointer text-text-2 text-hover flex h-full items-center whitespace-nowrap text-[14px] font-[500]">设计模式</a></nav></div><div class="h-full"><nav class="mx-[12px] h-full justify-end"><a class="cursor-pointer text-text-2 text-hover flex h-full items-center whitespace-nowrap text-[14px] font-[500]">笔记</a></nav></div><div class="h-full"><nav class="mx-[12px] h-full justify-end"><a class="cursor-pointer text-brand text-hover flex h-full items-center whitespace-nowrap text-[14px] font-[500]">总结</a></nav></div><div class="h-full"><nav class="mx-[12px] h-full justify-end"><a class="cursor-pointer text-text-2 text-hover flex h-full items-center whitespace-nowrap text-[14px] font-[500]">收集</a></nav></div><div class="h-full"><nav class="mx-[12px] h-full justify-end"><a class="cursor-pointer text-text-2 text-hover flex h-full items-center whitespace-nowrap text-[14px] font-[500]">业务</a></nav></div><div class="h-full"><nav class="mx-[4px] flex h-full items-center"><button class="bg-bg-switch border-divider hover:border-gray-1 relative h-[22px] w-[40px] rounded-[11px] border transition-colors duration-300"><div class="bg-bg-inverse shadow-1 absolute left-px top-px h-[18px] w-[18px] overflow-hidden rounded-[50%] transition-all duration-300 dark:translate-x-[18px]"><span class="*:text-text-2 *:absolute *:left-[3px] *:top-[3px] *:h-[12px] *:w-[12px] *:transition-opacity *:duration-300"><div class="icon-[carbon--sun] opacity-100 dark:opacity-0"></div><div class="icon-[carbon--moon] opacity-0 dark:opacity-100"></div></span></div></button></nav></div><div class="h-full"><nav class="mx-[12px] h-full"><a href="https://github.com/houhongxu/hhxpress" class="cursor-pointer text-text-2 text-hover flex  h-full items-center"><span class="icon-[carbon--logo-github] h-[24px] w-[24px]"></span></a></nav></div></div></div></div></header><div class="pt-nav"><aside class="mt-nav w-sidebar border-divider bg-bg-sidebar pc:-translate-x-0 fixed inset-y-0 left-0 z-40 -translate-x-full overflow-y-auto border-r px-[28px] py-[16px] transition-transform duration-300"><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>介绍</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:27px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">intro</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>http</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:324px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">http1与2与3</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">http与https</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">状态码</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">缓存</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">跨域</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">Cookie</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">安全</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">内容协商</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">CDN</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">文件上传</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">防盗链</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">浏览器构建HTTP请求行时怎么确定HTTP版本的</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>浏览器</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:54px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">从url开始的长篇大论</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">同站同进程</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>css</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:297px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">盒模型</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">水平垂直居中</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">左侧固定右侧自适应</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">三列均分布局</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">长宽比固定的元素</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">三角形元素</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">选择器权重</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">层叠上下文</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">格式化上下文</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">文本的样式处理</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">readme</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>javascript</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:243px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">变量提升 与 闭包 与 this 与 new 那得从 V8 执行上下文 说起</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">看得见的原型链</a><a class="cursor-pointer text-brand text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">还在手写promise呢</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">防抖与节流</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">apply与call与bind</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">深拷贝</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">promiseMap</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">事件委托</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">readme</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>react</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:378px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">react原理</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">不应该有闭包陷阱这个问题</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">理论上useCallback可以被完全替换</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">memo 为什么需要和 useCallback或useMemo 搭配</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">hook 作弊器 useReducer</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">diff算法</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">react hooks并不依赖fiber</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">context你怎么回事</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">state的同步异步</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">函数组件没有ErrorBoundary怎么办</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">调度lane</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">并发？批处理？</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">vdom提高性能？</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">todo</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>webpack</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:54px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">为什么 webpack 仍然必要</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">分包</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>vite</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:54px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">为什么vite比webpack快</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">vite和webpack HMR</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>工程化</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:108px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">模块化是工程化的起源</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">npm包</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">构建工具分类</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">todo</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>业务</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:243px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">移动端为主的宽度响应设计</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">首屏优化可以放5s广告吗</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">详情页优化</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">图片展示</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">文件上传</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">登录鉴权</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">深色模式</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">埋点问题</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">如何实现加载进度条</a></div></div></aside><div class="pc:ml-sidebar ml-0 flex justify-between"><div class="mx-auto w-full max-w-[768px] transition-[margin] duration-300"><div class="h-nav pc:hidden bg-bg-default sticky top-0 z-50 w-full border-b"><div class="flex h-full items-center justify-between px-[24px]"><a class="icon-[carbon--list] h-[24px] w-[24px] cursor-pointer"></a><a class="icon-[carbon--border-top] h-[24px] w-[24px] cursor-pointer"></a></div><div class="fixed inset-0 bg-[#00000060] transition-all duration-300 opacity-0 invisible"></div><aside class="w-sidebar border-divider bg-bg-sidebar fixed inset-y-0 left-0 z-40 overflow-y-auto border-r px-[28px] py-[16px] transition-transform duration-300 -translate-x-full"><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>介绍</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:27px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">intro</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>http</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:324px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">http1与2与3</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">http与https</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">状态码</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">缓存</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">跨域</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">Cookie</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">安全</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">内容协商</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">CDN</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">文件上传</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">防盗链</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">浏览器构建HTTP请求行时怎么确定HTTP版本的</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>浏览器</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:54px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">从url开始的长篇大论</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">同站同进程</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>css</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:297px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">盒模型</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">水平垂直居中</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">左侧固定右侧自适应</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">三列均分布局</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">长宽比固定的元素</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">三角形元素</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">选择器权重</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">层叠上下文</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">格式化上下文</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">文本的样式处理</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">readme</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>javascript</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:243px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">变量提升 与 闭包 与 this 与 new 那得从 V8 执行上下文 说起</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">看得见的原型链</a><a class="cursor-pointer text-brand text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">还在手写promise呢</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">防抖与节流</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">apply与call与bind</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">深拷贝</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">promiseMap</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">事件委托</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">readme</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>react</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:378px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">react原理</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">不应该有闭包陷阱这个问题</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">理论上useCallback可以被完全替换</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">memo 为什么需要和 useCallback或useMemo 搭配</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">hook 作弊器 useReducer</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">diff算法</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">react hooks并不依赖fiber</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">context你怎么回事</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">state的同步异步</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">函数组件没有ErrorBoundary怎么办</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">调度lane</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">并发？批处理？</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">vdom提高性能？</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">todo</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>webpack</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:54px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">为什么 webpack 仍然必要</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">分包</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>vite</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:54px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">为什么vite比webpack快</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">vite和webpack HMR</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>工程化</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:108px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">模块化是工程化的起源</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">npm包</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">构建工具分类</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">todo</a></div></div><div class="border-divider mt-[4px] border-t first:mt-0 first:border-t-0"><h2 class="text-text-1 mb-[6px] mt-[12px] flex cursor-pointer items-center justify-between font-[700]"><span>业务</span><span class="rotate-90 icon-[carbon--chevron-right] transition-transform duration-300"></span></h2><div style="height:243px" class="mb-[12px] flex flex-col overflow-hidden pl-[1rem] transition-[height] duration-300"><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">移动端为主的宽度响应设计</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">首屏优化可以放5s广告吗</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">详情页优化</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">图片展示</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">文件上传</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">登录鉴权</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">深色模式</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">埋点问题</a><a class="cursor-pointer text-text-2 text-hover mb-[2px] overflow-hidden text-ellipsis whitespace-nowrap p-[2px] text-[14px]">如何实现加载进度条</a></div></div></aside><div class="fixed inset-0  bg-[#00000060] transition-all duration-300 opacity-0 invisible"></div><aside class="w-toc border-divider bg-bg-sidebar fixed inset-y-0 right-0 z-40  h-full border-l px-[28px] py-[16px] transition-transform duration-300 translate-x-full"><div class="border-divider pc:border-l px-[16px] font-[500]"><div class="pc:block bg-brand absolute left-0 hidden h-[18px] w-px transition-[opacity,top] duration-300" style="top:33px;opacity:0"></div><div class="text-[14px] font-[600] leading-[28px]">本页目录</div><div><div><a href="#mypromise" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">myPromise</a></div><div><a href="#resolvepromise" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">resolvePromise</a></div><div><a href="#all" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">all</a></div><div><a href="#allsettled" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">allsettled</a></div><div><a href="#race" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">race</a></div><div><a href="#any" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">any</a></div><div><a href="#参考资料" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">参考资料</a></div></div></div></aside></div><div class="p-[48px]"><div class="doc"><h1 id="还在手写-promise-呢"><a class="autolink-headings" href="#还在手写-promise-呢"><span style="margin-right:4px">#</span></a>还在手写 promise 呢</h1>
<h2 id="mypromise"><a class="autolink-headings" href="#mypromise"><span style="margin-right:4px">#</span></a>myPromise</h2>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#fff;color:#24292e" tabindex="0" data-language="js" data-theme="github-light"><code data-language="js" data-theme="github-light" style="display:grid"><span data-line=""><span style="color:#D73A49">const</span><span style="color:#005CC5"> STATES</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">  pending: </span><span style="color:#032F62">&#x27;pending&#x27;</span><span style="color:#24292E">,</span></span>
<span data-line=""><span style="color:#24292E">  fulfilled: </span><span style="color:#032F62">&#x27;fulfilled&#x27;</span><span style="color:#24292E">,</span></span>
<span data-line=""><span style="color:#24292E">  rejected: </span><span style="color:#032F62">&#x27;rejected&#x27;</span><span style="color:#24292E">,</span></span>
<span data-line=""><span style="color:#24292E">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">function</span><span style="color:#6F42C1"> MyPromiseError</span><span style="color:#24292E">(</span><span style="color:#E36209">message</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">  return</span><span style="color:#032F62"> `Uncaught (in myPromise) ${</span><span style="color:#24292E">message</span><span style="color:#032F62">}`</span></span>
<span data-line=""><span style="color:#24292E">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">class</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">  // 初始化state为等待态</span></span>
<span data-line=""><span style="color:#E36209">  state</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.pending</span></span>
<span data-line=""><span style="color:#6A737D">  // 成功的值</span></span>
<span data-line=""><span style="color:#E36209">  value</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> undefined</span></span>
<span data-line=""><span style="color:#6A737D">  // 失败的原因</span></span>
<span data-line=""><span style="color:#E36209">  reason</span><span style="color:#D73A49"> =</span><span style="color:#005CC5"> undefined</span></span>
<span data-line=""><span style="color:#6A737D">  // onFulfilled事件订阅者</span></span>
<span data-line=""><span style="color:#E36209">  onFulfilledCallbacks</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> []</span></span>
<span data-line=""><span style="color:#6A737D">  // onRejected事件订阅者</span></span>
<span data-line=""><span style="color:#E36209">  onRejectedCallbacks</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> []</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">  constructor</span><span style="color:#24292E">(</span><span style="color:#E36209">executor</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">    if</span><span style="color:#24292E"> (</span><span style="color:#D73A49">typeof</span><span style="color:#24292E"> executor </span><span style="color:#D73A49">!==</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">      throw</span><span style="color:#032F62"> &#x27;参数executor不是函数&#x27;</span></span>
<span data-line=""><span style="color:#24292E">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">    // 成功</span></span>
<span data-line=""><span style="color:#D73A49">    const</span><span style="color:#6F42C1"> resolve</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> (</span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.pending) {</span></span>
<span data-line=""><span style="color:#005CC5">        this</span><span style="color:#24292E">.value </span><span style="color:#D73A49">=</span><span style="color:#24292E"> value</span></span>
<span data-line=""><span style="color:#005CC5">        this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.fulfilled</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">        // 发布onFulfilled事件通知</span></span>
<span data-line=""><span style="color:#005CC5">        this</span><span style="color:#24292E">.onFulfilledCallbacks.</span><span style="color:#6F42C1">forEach</span><span style="color:#24292E">((</span><span style="color:#E36209">fn</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#6F42C1"> fn</span><span style="color:#24292E">())</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#24292E">      console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;resolve&#x27;</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.state, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.value, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""><span style="color:#24292E">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">    // 失败</span></span>
<span data-line=""><span style="color:#D73A49">    const</span><span style="color:#6F42C1"> reject</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> (</span><span style="color:#E36209">reason</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.pending) {</span></span>
<span data-line=""><span style="color:#005CC5">        this</span><span style="color:#24292E">.reason </span><span style="color:#D73A49">=</span><span style="color:#24292E"> reason</span></span>
<span data-line=""><span style="color:#005CC5">        this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.rejected</span></span>
<span data-line=""><span style="color:#24292E">        console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#005CC5">222222</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.state, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">        // 发布onRejected事件通知</span></span>
<span data-line=""><span style="color:#005CC5">        this</span><span style="color:#24292E">.onRejectedCallbacks.</span><span style="color:#6F42C1">forEach</span><span style="color:#24292E">((</span><span style="color:#E36209">fn</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#6F42C1"> fn</span><span style="color:#24292E">())</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">      // ? promise如何实现的报错提示，promise会先返回值再提示报错，普通值和异步值都是</span></span>
<span data-line=""><span style="color:#6A737D">      // 此处模拟实现则是普通值是先提示报错再返回，因为先执行console.error才执行完，异步值才是先返回再报错</span></span>
<span data-line=""><span style="color:#24292E">      console.</span><span style="color:#6F42C1">error</span><span style="color:#24292E">(</span><span style="color:#6F42C1">MyPromiseError</span><span style="color:#24292E">(reason))</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#24292E">      console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;reject&#x27;</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.state, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.value, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""><span style="color:#24292E">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">    try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">      // 立即执行回调executor</span></span>
<span data-line=""><span style="color:#6F42C1">      executor</span><span style="color:#24292E">(resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">    } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">      reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">    }</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6F42C1">  then</span><span style="color:#24292E">(</span><span style="color:#E36209">onFulfilled</span><span style="color:#24292E">, </span><span style="color:#E36209">onRejected</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#24292E">    console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;---&#x27;</span><span style="color:#24292E">, </span><span style="color:#032F62">&#x27;then&#x27;</span><span style="color:#24292E">, </span><span style="color:#032F62">&#x27;---&#x27;</span><span style="color:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">    if</span><span style="color:#24292E"> (</span><span style="color:#D73A49">typeof</span><span style="color:#24292E"> onFulfilled </span><span style="color:#D73A49">!==</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6F42C1">      onFulfilled</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> (</span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> value</span></span>
<span data-line=""><span style="color:#24292E">    }</span></span>
<span data-line=""><span style="color:#D73A49">    if</span><span style="color:#24292E"> (</span><span style="color:#D73A49">typeof</span><span style="color:#24292E"> onRejected </span><span style="color:#D73A49">!==</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6F42C1">      onRejected</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> (</span><span style="color:#E36209">reason</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">        throw</span><span style="color:#24292E"> reason</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">    // 实现链式调用</span></span>
<span data-line=""><span style="color:#D73A49">    const</span><span style="color:#005CC5"> promise2</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">      // 成功的任务立即执行onFulfilled回调并返回</span></span>
<span data-line=""><span style="color:#D73A49">      if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.fulfilled) {</span></span>
<span data-line=""><span style="color:#D73A49">        try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">          console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;onFulfilled&#x27;</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.state, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.value, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">          const</span><span style="color:#005CC5"> x</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> onFulfilled</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">.value)</span></span>
<span data-line=""><span style="color:#6F42C1">          resolvePromise</span><span style="color:#24292E">(promise2, x, resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">          reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">      // 失败的任务立即执行onRejected回调并返回</span></span>
<span data-line=""><span style="color:#D73A49">      if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.rejected) {</span></span>
<span data-line=""><span style="color:#D73A49">        try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">          console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;onRejected&#x27;</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.state, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.value, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">          const</span><span style="color:#005CC5"> x</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> onRejected</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""><span style="color:#6F42C1">          resolvePromise</span><span style="color:#24292E">(promise2, x, resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">          reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">      // 还没有结果的异步任务</span></span>
<span data-line=""><span style="color:#D73A49">      if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;pending&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#24292E">        console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;异步事件等待完成&#x27;</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.state, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.value, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">        // 订阅onFulfilled事件</span></span>
<span data-line=""><span style="color:#005CC5">        this</span><span style="color:#24292E">.onFulfilledCallbacks.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">          try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">            const</span><span style="color:#005CC5"> x</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> onFulfilled</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">.value)</span></span>
<span data-line=""><span style="color:#6F42C1">            resolvePromise</span><span style="color:#24292E">(promise2, x, resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">          } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">            reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">          }</span></span>
<span data-line=""><span style="color:#24292E">        })</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">        // 订阅onRejected事件</span></span>
<span data-line=""><span style="color:#005CC5">        this</span><span style="color:#24292E">.onRejectedCallbacks.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">          try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">            const</span><span style="color:#005CC5"> x</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> onRejected</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""><span style="color:#6F42C1">            resolvePromise</span><span style="color:#24292E">(promise2, x, resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">          } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">            reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">          }</span></span>
<span data-line=""><span style="color:#24292E">        })</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#24292E">    console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;---&#x27;</span><span style="color:#24292E">, </span><span style="color:#032F62">&#x27;---&#x27;</span><span style="color:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#24292E"> promise2</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6F42C1">  catch</span><span style="color:#24292E">(</span><span style="color:#E36209">onRejected</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">    // 就是一个只处理失败态的 then</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#005CC5"> this</span><span style="color:#24292E">.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">(</span><span style="color:#005CC5">undefined</span><span style="color:#24292E">, onRejected)</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">  // ! 需要resolvePromise支持</span></span>
<span data-line=""><span style="color:#6F42C1">  finally</span><span style="color:#24292E">(</span><span style="color:#E36209">onFinally</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">    // 就是一个，成功和失败都执行onFinally，且返回一个onFinally返回值的then</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#005CC5"> this</span><span style="color:#24292E">.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">(</span></span>
<span data-line=""><span style="color:#24292E">      (</span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> myPromise.</span><span style="color:#6F42C1">resolve</span><span style="color:#24292E">(</span><span style="color:#6F42C1">onFinally</span><span style="color:#24292E">()).</span><span style="color:#6F42C1">then</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> value),</span></span>
<span data-line=""><span style="color:#24292E">      (</span><span style="color:#E36209">reason</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span></span>
<span data-line=""><span style="color:#24292E">        myPromise.</span><span style="color:#6F42C1">resolve</span><span style="color:#24292E">(</span><span style="color:#6F42C1">onFinally</span><span style="color:#24292E">()).</span><span style="color:#6F42C1">then</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">          throw</span><span style="color:#24292E"> reason</span></span>
<span data-line=""><span style="color:#24292E">        }),</span></span>
<span data-line=""><span style="color:#24292E">    )</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">  static</span><span style="color:#6F42C1"> resolve</span><span style="color:#24292E">(</span><span style="color:#E36209">value</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">      resolve</span><span style="color:#24292E">(value)</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">  static</span><span style="color:#6F42C1"> reject</span><span style="color:#24292E">(</span><span style="color:#E36209">value</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">      reject</span><span style="color:#24292E">(value)</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">  static</span><span style="color:#6F42C1"> all</span><span style="color:#24292E">(</span><span style="color:#E36209">promises</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#005CC5"> result</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> []</span></span>
<span data-line=""><span style="color:#6A737D">      // 记录完成次数</span></span>
<span data-line=""><span style="color:#D73A49">      let</span><span style="color:#24292E"> count </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#6F42C1"> handleResult</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> (</span><span style="color:#E36209">index</span><span style="color:#24292E">, </span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">        result[index] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> value</span></span>
<span data-line=""><span style="color:#24292E">        count</span><span style="color:#D73A49">++</span></span>
<span data-line=""><span style="color:#6A737D">        // 全部完成则resolve</span></span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (count </span><span style="color:#D73A49">===</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6F42C1">          resolve</span><span style="color:#24292E">(result)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">      for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">        // 获取每一个异步任务</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> p</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> promises[i]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (p </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> p.then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">          // 异步值，异步结束获取结果</span></span>
<span data-line=""><span style="color:#24292E">          p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">((</span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            handleResult</span><span style="color:#24292E">(i, value)</span></span>
<span data-line=""><span style="color:#24292E">          }, reject) </span><span style="color:#6A737D">// 有一个失败则直接reject</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">          // 普通值，直接获取结果</span></span>
<span data-line=""><span style="color:#6F42C1">          handleResult</span><span style="color:#24292E">(i, p)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">  static</span><span style="color:#6F42C1"> allSettled</span><span style="color:#24292E">(</span><span style="color:#E36209">promises</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#005CC5"> result</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> Array</span><span style="color:#24292E">(promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#6A737D">      // 记录完成次数</span></span>
<span data-line=""><span style="color:#D73A49">      let</span><span style="color:#24292E"> count </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#6F42C1"> handleResult</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> (</span><span style="color:#E36209">index</span><span style="color:#24292E">, </span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">        result[index] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> value</span></span>
<span data-line=""><span style="color:#24292E">        count</span><span style="color:#D73A49">++</span></span>
<span data-line=""><span style="color:#6A737D">        // 全部完成则resolve</span></span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (count </span><span style="color:#D73A49">===</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6F42C1">          resolve</span><span style="color:#24292E">(result)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">      for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">        // 获取每一个异步任务</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> p</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> promises[i]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (p </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> p.then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">          // 异步值，异步结束获取结果</span></span>
<span data-line=""><span style="color:#24292E">          p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">((</span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            handleResult</span><span style="color:#24292E">(i, value)</span></span>
<span data-line=""><span style="color:#24292E">          }).</span><span style="color:#6F42C1">catch</span><span style="color:#24292E">((</span><span style="color:#E36209">reason</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            handleResult</span><span style="color:#24292E">(i, reason)</span></span>
<span data-line=""><span style="color:#24292E">          })</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">          // 普通值，直接获取结果</span></span>
<span data-line=""><span style="color:#6F42C1">          handleResult</span><span style="color:#24292E">(i, p)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">  static</span><span style="color:#6F42C1"> race</span><span style="color:#24292E">(</span><span style="color:#E36209">promises</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">        // 获取每一个异步任务</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> p</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> promises[i]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (p </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> p.then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">          // 异步值，使用第一个触发then的</span></span>
<span data-line=""><span style="color:#24292E">          p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">(resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">          // 普通值，直接获取结果</span></span>
<span data-line=""><span style="color:#6F42C1">          resolve</span><span style="color:#24292E">(p)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">  static</span><span style="color:#6F42C1"> any</span><span style="color:#24292E">(</span><span style="color:#E36209">promises</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">    const</span><span style="color:#005CC5"> rejectedArr</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> Array</span><span style="color:#24292E">(promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">        // 获取每一个异步任务</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> p</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> promises[i]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (p </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> p.then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">          // 异步值，使用第一个成功的，失败的存到数组直到全部失败则返回</span></span>
<span data-line=""><span style="color:#24292E">          p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">(resolve, (</span><span style="color:#E36209">reason</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">            rejectedArr[i] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> reason</span></span>
<span data-line=""><span style="color:#D73A49">            if</span><span style="color:#24292E"> (rejectedArr.</span><span style="color:#005CC5">length</span><span style="color:#D73A49"> ===</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6F42C1">              reject</span><span style="color:#24292E">(rejectedArr)</span></span>
<span data-line=""><span style="color:#24292E">            }</span></span>
<span data-line=""><span style="color:#24292E">          })</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">          // 普通值，直接获取结果</span></span>
<span data-line=""><span style="color:#6F42C1">          resolve</span><span style="color:#24292E">(p)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""><span style="color:#24292E">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">function</span><span style="color:#6F42C1"> resolvePromise</span><span style="color:#24292E">(</span><span style="color:#E36209">promise2</span><span style="color:#24292E">, </span><span style="color:#E36209">x</span><span style="color:#24292E">, </span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">  // 根据返回值 x 的情况，调用 promise2 的 resolve 或 reject 函数</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">  // 返回值循环引用</span></span>
<span data-line=""><span style="color:#D73A49">  if</span><span style="color:#24292E"> (promise2 </span><span style="color:#D73A49">===</span><span style="color:#24292E"> x) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> reject</span><span style="color:#24292E">(</span><span style="color:#D73A49">new</span><span style="color:#6F42C1"> TypeError</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;循环引用&#x27;</span><span style="color:#24292E">))</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">  // 返回值 x 是对象或函数的情况</span></span>
<span data-line=""><span style="color:#D73A49">  if</span><span style="color:#24292E"> (x </span><span style="color:#D73A49">!==</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> &amp;&amp;</span><span style="color:#24292E"> (</span><span style="color:#D73A49">typeof</span><span style="color:#24292E"> x </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;object&#x27;</span><span style="color:#D73A49"> ||</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> x </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">)) {</span></span>
<span data-line=""><span style="color:#D73A49">    try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#005CC5"> then</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> x.then</span></span>
<span data-line=""><span style="color:#D73A49">      if</span><span style="color:#24292E"> (</span><span style="color:#D73A49">typeof</span><span style="color:#24292E"> then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">        // then 是函数：就认为 x 为 Promise 类型</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">        // 返回值 x 为 Promise，调用 then 看结果</span></span>
<span data-line=""><span style="color:#24292E">        then.</span><span style="color:#6F42C1">call</span><span style="color:#24292E">(</span></span>
<span data-line=""><span style="color:#24292E">          x,</span></span>
<span data-line=""><span style="color:#24292E">          (</span><span style="color:#E36209">y</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            resolve</span><span style="color:#24292E">(y) </span><span style="color:#6A737D">// 成功</span></span>
<span data-line=""><span style="color:#24292E">          },</span></span>
<span data-line=""><span style="color:#24292E">          (</span><span style="color:#E36209">r</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            reject</span><span style="color:#24292E">(r) </span><span style="color:#6A737D">// 失败</span></span>
<span data-line=""><span style="color:#24292E">          },</span></span>
<span data-line=""><span style="color:#24292E">        )</span></span>
<span data-line=""><span style="color:#24292E">      } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">        resolve</span><span style="color:#24292E">(x) </span><span style="color:#6A737D">// 普通值</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">      reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">    }</span></span>
<span data-line=""><span style="color:#24292E">  } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">    console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;应该是普通值&#x27;</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#6A737D">    // 普通值</span></span>
<span data-line=""><span style="color:#6F42C1">    resolve</span><span style="color:#24292E">(x)</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""><span style="color:#24292E">}</span></span></code></pre></figure>
<h2 id="resolvepromise"><a class="autolink-headings" href="#resolvepromise"><span style="margin-right:4px">#</span></a>resolvePromise</h2>
<p>resolvePromise 解决 promise 循环引用等等 问题</p>
<p>如下，如果 then 的返回值是 p2，那么因为 p2 一直是 pending，所以在 then 中发布了 onFulfilled 事件后一直无法完成，应该报循环引用错误</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#fff;color:#24292e" tabindex="0" data-language="js" data-theme="github-light"><code data-language="js" data-theme="github-light" style="display:grid"><span data-line=""><span style="color:#D73A49">let</span><span style="color:#24292E"> p </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#005CC5"> Promise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">  resolve</span><span style="color:#24292E">(</span><span style="color:#005CC5">0</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#24292E">})</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">var</span><span style="color:#24292E"> p2 </span><span style="color:#D73A49">=</span><span style="color:#24292E"> p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">((</span><span style="color:#E36209">data</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">  // 循环引用，自己等待自己完成，一辈子完不成</span></span>
<span data-line=""><span style="color:#D73A49">  return</span><span style="color:#24292E"> p2</span></span>
<span data-line=""><span style="color:#24292E">})</span></span></code></pre></figure>
<p>如果没处理则无限循环了</p>
<p>所以我们应该根据 then 中方法的返回值 x ，决定 promise2 执行成功/失败处理</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#fff;color:#24292e" tabindex="0" data-language="js" data-theme="github-light"><code data-language="js" data-theme="github-light" style="display:grid"><span data-line=""><span style="color:#D73A49">function</span><span style="color:#6F42C1"> resolvePromise</span><span style="color:#24292E">(</span><span style="color:#E36209">promise2</span><span style="color:#24292E">, </span><span style="color:#E36209">x</span><span style="color:#24292E">, </span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">  // 根据返回值 x 的情况，调用 promise2 的 resolve 或 reject 函数</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">  // 返回值循环引用</span></span>
<span data-line=""><span style="color:#D73A49">  if</span><span style="color:#24292E"> (promise2 </span><span style="color:#D73A49">===</span><span style="color:#24292E"> x) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#6F42C1"> reject</span><span style="color:#24292E">(</span><span style="color:#D73A49">new</span><span style="color:#6F42C1"> TypeError</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;循环引用&#x27;</span><span style="color:#24292E">))</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">  // 返回值 x 是对象或函数的情况</span></span>
<span data-line=""><span style="color:#D73A49">  if</span><span style="color:#24292E"> (x </span><span style="color:#D73A49">!==</span><span style="color:#005CC5"> null</span><span style="color:#D73A49"> &amp;&amp;</span><span style="color:#24292E"> (</span><span style="color:#D73A49">typeof</span><span style="color:#24292E"> x </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;object&#x27;</span><span style="color:#D73A49"> ||</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> x </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">)) {</span></span>
<span data-line=""><span style="color:#D73A49">    try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#005CC5"> then</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> x.then</span></span>
<span data-line=""><span style="color:#D73A49">      if</span><span style="color:#24292E"> (</span><span style="color:#D73A49">typeof</span><span style="color:#24292E"> then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">        // then 是函数：就认为 x 为 Promise 类型</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">        // 返回值 x 为 Promise，调用 then 看结果</span></span>
<span data-line=""><span style="color:#24292E">        then.</span><span style="color:#6F42C1">call</span><span style="color:#24292E">(</span></span>
<span data-line=""><span style="color:#24292E">          x,</span></span>
<span data-line=""><span style="color:#24292E">          (</span><span style="color:#E36209">y</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            resolve</span><span style="color:#24292E">(y) </span><span style="color:#6A737D">// 成功</span></span>
<span data-line=""><span style="color:#24292E">          },</span></span>
<span data-line=""><span style="color:#24292E">          (</span><span style="color:#E36209">r</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            reject</span><span style="color:#24292E">(r) </span><span style="color:#6A737D">// 失败</span></span>
<span data-line=""><span style="color:#24292E">          },</span></span>
<span data-line=""><span style="color:#24292E">        )</span></span>
<span data-line=""><span style="color:#24292E">      } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">        resolve</span><span style="color:#24292E">(x) </span><span style="color:#6A737D">// 普通值</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">      reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">    }</span></span>
<span data-line=""><span style="color:#24292E">  } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">    console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#032F62">&#x27;应该是普通值&#x27;</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#6A737D">    // 普通值</span></span>
<span data-line=""><span style="color:#6F42C1">    resolve</span><span style="color:#24292E">(x)</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""><span style="color:#24292E">}</span></span></code></pre></figure>
<p>但是在 new promise 时，promise2 还没有完成初始化,所以 resolvePromise 中不能访问到 promise2</p>
<p>创建新宏任务在下一个事件循环中执行，这样调用 resolvePromise 时，promise2 一定是创建完成的</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#fff;color:#24292e" tabindex="0" data-language="js" data-theme="github-light"><code data-language="js" data-theme="github-light" style="display:grid"><span data-line=""><span style="color:#6A737D">// 实现链式调用</span></span>
<span data-line=""><span style="color:#D73A49">const</span><span style="color:#005CC5"> promise2</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">  // 成功的任务立即执行onFulfilled回调并返回</span></span>
<span data-line=""><span style="color:#D73A49">  if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.fulfilled) {</span></span>
<span data-line=""><span style="color:#6A737D">    // 创建新宏任务在下一个事件循环中执行，这样调用 resolvePromise 时，promise2 一定是创建完成的</span></span>
<span data-line=""><span style="color:#6F42C1">    setTimeout</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> x</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> onFulfilled</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">.value)</span></span>
<span data-line=""><span style="color:#6A737D">        // 根据返回值x类型来选择逻辑</span></span>
<span data-line=""><span style="color:#6F42C1">        resolvePromise</span><span style="color:#24292E">(promise2, x, resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">      } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">        reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    }, </span><span style="color:#005CC5">0</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">  // 失败的任务立即执行onRejected回调并返回</span></span>
<span data-line=""><span style="color:#D73A49">  if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">===</span><span style="color:#005CC5"> STATES</span><span style="color:#24292E">.rejected) {</span></span>
<span data-line=""><span style="color:#6F42C1">    setTimeout</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> x</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> onRejected</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""><span style="color:#6F42C1">        resolvePromise</span><span style="color:#24292E">(promise2, x, resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">        console.</span><span style="color:#6F42C1">log</span><span style="color:#24292E">(</span><span style="color:#005CC5">11111</span><span style="color:#24292E">, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.state, </span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""><span style="color:#24292E">      } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">        reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    }, </span><span style="color:#005CC5">0</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">  // 还没有结果的异步任务</span></span>
<span data-line=""><span style="color:#D73A49">  if</span><span style="color:#24292E"> (</span><span style="color:#005CC5">this</span><span style="color:#24292E">.state </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;pending&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">    // 订阅onFulfilled事件</span></span>
<span data-line=""><span style="color:#005CC5">    this</span><span style="color:#24292E">.onFulfilledCallbacks.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">      setTimeout</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">        try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">          const</span><span style="color:#005CC5"> x</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> onFulfilled</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">.value)</span></span>
<span data-line=""><span style="color:#6F42C1">          resolvePromise</span><span style="color:#24292E">(promise2, x, resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">          reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }, </span><span style="color:#005CC5">0</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#6A737D">    // 订阅onRejected事件</span></span>
<span data-line=""><span style="color:#005CC5">    this</span><span style="color:#24292E">.onRejectedCallbacks.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">      setTimeout</span><span style="color:#24292E">(() </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">        try</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">          const</span><span style="color:#005CC5"> x</span><span style="color:#D73A49"> =</span><span style="color:#6F42C1"> onRejected</span><span style="color:#24292E">(</span><span style="color:#005CC5">this</span><span style="color:#24292E">.reason)</span></span>
<span data-line=""><span style="color:#6F42C1">          resolvePromise</span><span style="color:#24292E">(promise2, x, resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">catch</span><span style="color:#24292E"> (e) {</span></span>
<span data-line=""><span style="color:#6F42C1">          reject</span><span style="color:#24292E">(e)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }, </span><span style="color:#005CC5">0</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span>
<span data-line=""><span style="color:#24292E">})</span></span></code></pre></figure>
<h2 id="all"><a class="autolink-headings" href="#all"><span style="margin-right:4px">#</span></a>all</h2>
<p>批量执行 Promise，返回一个 Promise 实例，里面值为输入顺序的数组
全部成功才算成功，返回全部执行结果
有一个失败就算失败，返回第一个失败结果</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#fff;color:#24292e" tabindex="0" data-language="js" data-theme="github-light"><code data-language="js" data-theme="github-light" style="display:grid"><span data-line=""><span style="color:#24292E">static </span><span style="color:#6F42C1">all</span><span style="color:#24292E">(promises) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#005CC5"> result</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> Array</span><span style="color:#24292E">(promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#6A737D">      // 记录完成次数</span></span>
<span data-line=""><span style="color:#D73A49">      let</span><span style="color:#24292E"> count </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#6F42C1"> handleResult</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> (</span><span style="color:#E36209">index</span><span style="color:#24292E">, </span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">        result[index] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> value</span></span>
<span data-line=""><span style="color:#24292E">        count</span><span style="color:#D73A49">++</span></span>
<span data-line=""><span style="color:#6A737D">        // 全部完成则resolve</span></span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (count </span><span style="color:#D73A49">===</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6F42C1">          resolve</span><span style="color:#24292E">(result)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">      for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> p</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> promises[i]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (p </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> p.then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">          // 异步值，异步结束获取结果</span></span>
<span data-line=""><span style="color:#24292E">          p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">((</span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            handleResult</span><span style="color:#24292E">(i, value)</span></span>
<span data-line=""><span style="color:#24292E">          }, reject) </span><span style="color:#6A737D">// 有一个失败则直接reject</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">          // 普通值，直接获取结果</span></span>
<span data-line=""><span style="color:#6F42C1">          handleResult</span><span style="color:#24292E">(i, p)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span></code></pre></figure>
<h2 id="allsettled"><a class="autolink-headings" href="#allsettled"><span style="margin-right:4px">#</span></a>allsettled</h2>
<p>批处理 promise，返回一个 Promise 实例，里面值为输入顺序的数组
存在失败结果也会拿到全部执行结果</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#fff;color:#24292e" tabindex="0" data-language="js" data-theme="github-light"><code data-language="js" data-theme="github-light" style="display:grid"><span data-line=""><span style="color:#24292E">static </span><span style="color:#6F42C1">allsettled</span><span style="color:#24292E">(promises) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#005CC5"> result</span><span style="color:#D73A49"> =</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> Array</span><span style="color:#24292E">(promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">)</span></span>
<span data-line=""><span style="color:#6A737D">      // 记录完成次数</span></span>
<span data-line=""><span style="color:#D73A49">      let</span><span style="color:#24292E"> count </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">      const</span><span style="color:#6F42C1"> handleResult</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> (</span><span style="color:#E36209">index</span><span style="color:#24292E">, </span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#24292E">        result[index] </span><span style="color:#D73A49">=</span><span style="color:#24292E"> value</span></span>
<span data-line=""><span style="color:#24292E">        count</span><span style="color:#D73A49">++</span></span>
<span data-line=""><span style="color:#6A737D">        // 全部完成则resolve</span></span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (count </span><span style="color:#D73A49">===</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6F42C1">          resolve</span><span style="color:#24292E">(result)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">      for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> p</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> promises[i]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (p </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> p.then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">          // 异步值，异步结束获取结果</span></span>
<span data-line=""><span style="color:#24292E">          p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">((</span><span style="color:#E36209">value</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            handleResult</span><span style="color:#24292E">(i, value)</span></span>
<span data-line=""><span style="color:#24292E">          }).</span><span style="color:#6F42C1">catch</span><span style="color:#24292E">((</span><span style="color:#E36209">reason</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6F42C1">            handleResult</span><span style="color:#24292E">(i, reason)</span></span>
<span data-line=""><span style="color:#24292E">          })</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">          // 普通值，直接获取结果</span></span>
<span data-line=""><span style="color:#6F42C1">          handleResult</span><span style="color:#24292E">(i, p)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span></code></pre></figure>
<h2 id="race"><a class="autolink-headings" href="#race"><span style="margin-right:4px">#</span></a>race</h2>
<p>批处理 promise，返回一个 Promise 实例，里面值为最快完成的值，同步时为第一个
无论成功还是失败，谁快就返回谁</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#fff;color:#24292e" tabindex="0" data-language="js" data-theme="github-light"><code data-language="js" data-theme="github-light" style="display:grid"><span data-line=""><span style="color:#24292E">static </span><span style="color:#6F42C1">race</span><span style="color:#24292E">(promises) {</span></span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> p</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> promises[i]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (p </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> p.then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">          // 异步值，使用第一个触发then的</span></span>
<span data-line=""><span style="color:#24292E">          p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">(resolve, reject)</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">          // 普通值，直接获取结果</span></span>
<span data-line=""><span style="color:#6F42C1">          resolve</span><span style="color:#24292E">(p)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span></code></pre></figure>
<h2 id="any"><a class="autolink-headings" href="#any"><span style="margin-right:4px">#</span></a>any</h2>
<p>批处理 promise，返回一个 Promise 实例，里面值为最快成功的值
返回第一个成功结果，全部失败才返回失败</p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#fff;color:#24292e" tabindex="0" data-language="js" data-theme="github-light"><code data-language="js" data-theme="github-light" style="display:grid"><span data-line=""><span style="color:#24292E">static </span><span style="color:#6F42C1">any</span><span style="color:#24292E">(promises) {</span></span>
<span data-line=""><span style="color:#D73A49">  const</span><span style="color:#005CC5"> rejectedArr</span><span style="color:#D73A49">=new</span><span style="color:#6F42C1"> Array</span><span style="color:#24292E">(promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">    return</span><span style="color:#D73A49"> new</span><span style="color:#6F42C1"> myPromise</span><span style="color:#24292E">((</span><span style="color:#E36209">resolve</span><span style="color:#24292E">, </span><span style="color:#E36209">reject</span><span style="color:#24292E">) </span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#D73A49">      for</span><span style="color:#24292E"> (</span><span style="color:#D73A49">let</span><span style="color:#24292E"> i </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">; i </span><span style="color:#D73A49">&lt;</span><span style="color:#24292E"> promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">; i</span><span style="color:#D73A49">++</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#D73A49">        const</span><span style="color:#005CC5"> p</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> promises[i]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#D73A49">        if</span><span style="color:#24292E"> (p </span><span style="color:#D73A49">&amp;&amp;</span><span style="color:#D73A49"> typeof</span><span style="color:#24292E"> p.then </span><span style="color:#D73A49">===</span><span style="color:#032F62"> &#x27;function&#x27;</span><span style="color:#24292E">) {</span></span>
<span data-line=""><span style="color:#6A737D">          // 异步值，使用第一个成功的，失败的存到数组直到全部失败则返回</span></span>
<span data-line=""><span style="color:#24292E">          p.</span><span style="color:#6F42C1">then</span><span style="color:#24292E">(resolve,</span><span style="color:#E36209">reason</span><span style="color:#D73A49">=&gt;</span><span style="color:#24292E">{</span></span>
<span data-line=""><span style="color:#24292E">            rejectedArr[i]</span><span style="color:#D73A49">=</span><span style="color:#24292E">reason</span></span>
<span data-line=""><span style="color:#D73A49">            if</span><span style="color:#24292E">(rejectedArr.</span><span style="color:#005CC5">length</span><span style="color:#D73A49">===</span><span style="color:#24292E">promises.</span><span style="color:#005CC5">length</span><span style="color:#24292E">){</span></span>
<span data-line=""><span style="color:#6F42C1">              reject</span><span style="color:#24292E">(rejectedArr)</span></span>
<span data-line=""><span style="color:#24292E">            }</span></span>
<span data-line=""><span style="color:#24292E">          })</span></span>
<span data-line=""><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span data-line=""><span style="color:#6A737D">          // 普通值，直接获取结果</span></span>
<span data-line=""><span style="color:#6F42C1">          resolve</span><span style="color:#24292E">(p)</span></span>
<span data-line=""><span style="color:#24292E">        }</span></span>
<span data-line=""><span style="color:#24292E">      }</span></span>
<span data-line=""><span style="color:#24292E">    })</span></span>
<span data-line=""><span style="color:#24292E">  }</span></span></code></pre></figure>
<h2 id="参考资料"><a class="autolink-headings" href="#参考资料"><span style="margin-right:4px">#</span></a>参考资料</h2>
<p><a href="https://juejin.cn/user/4212984289165853/posts">掘金</a></p>
<p align="right">23.12.19</p></div><footer class="mt-[32px]"><div class="border-divider flex justify-between border-t pt-[24px]"><div class="w-[calc(50%-4px)]"><a class="cursor-pointer border-divider hover:border-brand group block h-full w-full rounded-[8px] border px-[16px] py-[8px] transition-colors duration-300"><div class="text-text-2 text-[12px] font-[500] leading-[20px]">上一页</div><div class=" text-text-2 group-hover:text-brand overflow-hidden text-ellipsis whitespace-nowrap text-[14px] font-[500] leading-[20px] transition-colors duration-300">看得见的原型链</div></a></div><div class="w-[calc(50%-4px)]"><a class="cursor-pointer border-divider hover:border-brand group block h-full w-full rounded-[8px] border px-[16px] py-[8px] transition-colors duration-300"><div class="text-text-2 text-[12px] font-[500] leading-[20px]">下一页</div><div class=" text-text-2 group-hover:text-brand overflow-hidden text-ellipsis whitespace-nowrap text-[14px] font-[500] leading-[20px] transition-colors duration-300">防抖与节流</div></a></div></div></footer></div></div><aside class="w-toc full:flex sticky top-[calc(theme(spacing.nav)+48px)] hidden h-full flex-col"><div class="border-divider pc:border-l px-[16px] font-[500]"><div class="pc:block bg-brand absolute left-0 hidden h-[18px] w-px transition-[opacity,top] duration-300" style="top:33px;opacity:0"></div><div class="text-[14px] font-[600] leading-[28px]">本页目录</div><div><div><a href="#mypromise" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">myPromise</a></div><div><a href="#resolvepromise" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">resolvePromise</a></div><div><a href="#all" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">all</a></div><div><a href="#allsettled" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">allsettled</a></div><div><a href="#race" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">race</a></div><div><a href="#any" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">any</a></div><div><a href="#参考资料" class="text-text-2 text-hover block overflow-hidden text-ellipsis whitespace-nowrap text-[13px] leading-[28px]" style="padding-left:0rem">参考资料</a></div></div></div></aside></div></div></div>
  
    <script type="module" src="/client-entry.js"></script>
    </body>
    
</html>
